parameters:
  JOB_PREFIX: ''
  VSCODE_ARCH: ''
  VSCODE_BUILD: true
  VSCODE_CIBUILD: true
  VSCODE_TEST: true

jobs:
  - job: ${{ parameters.JOB_PREFIX }}
    displayName: ${{ parameters.JOB_PREFIX }} (Compile)
    condition: and(succeeded(), eq('${{ parameters.VSCODE_BUILD }}', 'true'))
    timeoutInMinutes: 30
    variables:
      VSCODE_ARCH: ${{ parameters.VSCODE_ARCH }}
    steps:
      - template: product-compile-darwin.yml

  - job: ${{ parameters.JOB_PREFIX }}BrowserTests
    displayName: ${{ parameters.JOB_PREFIX }} (Browser Test)
    timeoutInMinutes: 30
    dependsOn:
      - ${{ parameters.JOB_PREFIX }}
    condition: and(succeeded(), eq('${{ parameters.VSCODE_TEST }}', 'true'))
    variables:
      VSCODE_ARCH: ${{ parameters.VSCODE_ARCH }}
    steps:
      - template: product-browser-tests-darwin.yml

  - job: ${{ parameters.JOB_PREFIX }}ElectronTests
    displayName: ${{ parameters.JOB_PREFIX }} (Electron Test)
    timeoutInMinutes: 30
    dependsOn:
      - ${{ parameters.JOB_PREFIX }}
    condition: and(succeeded(), eq('${{ parameters.VSCODE_TEST }}', 'true'))
    variables:
      VSCODE_ARCH: ${{ parameters.VSCODE_ARCH }}
    steps:
      - template: product-electron-tests-darwin.yml
